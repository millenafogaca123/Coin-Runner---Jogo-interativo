<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Coin Runner - Jogo</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
    @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
        font-family: 'Press Start 2P', cursive;
        background: url('assets/background.png') no-repeat center center fixed;
        background-size: cover;
        min-height: 100vh;
        overflow: hidden;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .game-container {
        position: relative;
        width: 800px;
        height: 500px;
        border: 4px solid #2c3e50;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        background: linear-gradient(to bottom, #87CEEB, #E0F7FA);
        outline: none;
    }

    .player {
        position: absolute;
        width: 50px;
        height: 50px;
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        border-radius: 50%;
        border: 3px solid #2c3e50;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        z-index: 10;
    }
    .player::before, .player::after {
        content: '';
        position: absolute;
        top: 10px;
        width: 8px; height: 8px;
        background: white;
        border-radius: 50%;
    }
    .player::before { left: 15px; }
    .player::after { right: 15px; }

    .coin {
        position: absolute;
        width: 30px; height: 30px;
        background: radial-gradient(circle at 30% 30%, #FFD700, #FFA500);
        border-radius: 50%;
        border: 2px solid #B8860B;
        animation: spin 2s linear infinite;
        box-shadow: 0 0 15px #FFD700;
        z-index: 5;
    }

    .obstacle {
        position: absolute;
        
        z-index: 5;
    }

    .score-display, .timer-display {
        position: absolute;
        top: 20px;
        background: rgba(255,255,255,0.9);
        padding: 10px 20px;
        border-radius: 20px;
        border: 3px solid #2c3e50;
        font-size: 14px;
        z-index: 20;
    }
    .score-display { left: 20px; }
    .timer-display { right: 20px; }

    .screen {
        position: absolute;
        top: 0; left: 0; width: 100%; height: 100%;
        display: flex; flex-direction: column;
        justify-content: center; align-items: center;
        background: rgba(44, 62, 80, 0.95);
        z-index: 100;
        color: white;
        text-align: center;
    }
    .hidden { display: none; }

    .btn {
        background: linear-gradient(45deg, #ff6b6b, #ee5a24);
        border: none;
        padding: 15px 30px;
        margin: 20px 0;
        border-radius: 25px;
        color: white;
        font-family: 'Press Start 2P', cursive;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.1s ease;
        border: 3px solid white;
        box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    }
    .btn:hover { transform: translateY(-3px); box-shadow: 0 12px 20px rgba(0,0,0,0.4); }

    @keyframes spin { 0% { transform: rotate(0deg);} 100% { transform: rotate(360deg);} }
    @keyframes collect { 0%{transform:scale(1);} 50%{transform:scale(1.5);opacity:0.5;} 100%{transform:scale(0);opacity:0;} }
    .collect-animation { animation: collect 0.5s forwards; }
</style>
</head>
<body>
<div class="game-container" id="game-container" tabindex="0">
    <div class="player" id="player"></div>
    <div class="score-display">Pontuação: <span id="score">0</span></div>
    <div class="timer-display">Tempo: <span id="timer">60</span>s</div>

    <div class="screen" id="start-screen">
        <h1 class="title">COIN RUNNER</h1>
        <p class="instructions">
            Use as setas do teclado ou arraste com o dedo!<br>
            Colete moedas, evite obstáculos, você tem 60 segundos!
        </p>
        <button class="btn" id="start-button">JOGAR</button>
    </div>

    <div class="screen game-over hidden" id="game-over-screen">
        <h1 class="title">GAME OVER</h1>
        <p>Sua pontuação final: <span id="final-score">0</span><br>
           Moedas coletadas: <span id="coins-collected">0</span></p>
        <button class="btn" id="restart-button">JOGAR NOVAMENTE</button>
    </div>
</div>

<script>
let gameActive=false, score=0, timeLeft=60, coinsCollected=0;
let gameTimer, obstacleTimer, coinTimer, playerMoveTimer;

const player=document.getElementById('player'),
      scoreDisplay=document.getElementById('score'),
      timerDisplay=document.getElementById('timer'),
      startScreen=document.getElementById('start-screen'),
      gameOverScreen=document.getElementById('game-over-screen'),
      finalScoreDisplay=document.getElementById('final-score'),
      coinsCollectedDisplay=document.getElementById('coins-collected'),
      gameContainer=document.getElementById('game-container'),
      startButton=document.getElementById('start-button'),
      restartButton=document.getElementById('restart-button');

let playerX=375, playerY=400, playerSpeed=10;
const playerBounds={left:0,right:750};
const keys={ArrowLeft:false,ArrowRight:false};

function init(){
    startButton.addEventListener('click', startGame);
    restartButton.addEventListener('click', restartGame);
    document.addEventListener('keydown', handleKeyDown);
    document.addEventListener('keyup', handleKeyUp);

    gameContainer.addEventListener('touchmove', (event)=>{
        if(!gameActive || event.touches.length!==1) return;
        const touchX=event.touches[0].clientX;
        const containerRect=gameContainer.getBoundingClientRect();
        let newX=touchX-containerRect.left-player.offsetWidth/2;
        newX=Math.max(playerBounds.left, Math.min(newX, playerBounds.right));
        playerX=newX; player.style.left=playerX+"px";
    });

    gameContainer.addEventListener('touchstart', (event)=>{
        if(!gameActive || event.touches.length!==1) return;
        const touchX=event.touches[0].clientX;
        const containerRect=gameContainer.getBoundingClientRect();
        const centerX=containerRect.left+containerRect.width/2;
        if(touchX<centerX){ playerX=Math.max(playerBounds.left, playerX-playerSpeed*5);}
        else{ playerX=Math.min(playerBounds.right, playerX+playerSpeed*5);}
        player.style.left=playerX+"px";
    });

    initPlayer(); 
    gameContainer.focus();
}

function initPlayer(){player.style.left=playerX+'px'; player.style.top=playerY+'px';}
function handleKeyDown(e){ if(['ArrowLeft','ArrowRight'].includes(e.key)) keys[e.key]=true; }
function handleKeyUp(e){ if(['ArrowLeft','ArrowRight'].includes(e.key)) keys[e.key]=false; }
function updatePlayerMovement(){
    if(!gameActive) return;
    if(keys.ArrowLeft) playerX=Math.max(playerBounds.left, playerX-playerSpeed);
    if(keys.ArrowRight) playerX=Math.min(playerBounds.right, playerX+playerSpeed);
    player.style.left=playerX+'px';
}

function startGame(){
    gameActive=true; score=0; coinsCollected=0; timeLeft=60;
    scoreDisplay.textContent=score; timerDisplay.textContent=timeLeft;
    startScreen.classList.add('hidden'); gameOverScreen.classList.add('hidden');
    document.querySelectorAll('.coin,.obstacle').forEach(el=>el.remove());
    playerX=375; initPlayer();
    startGameTimer(); spawnCoins(); spawnObstacles(); startPlayerMovement(); gameContainer.focus();
}

function startPlayerMovement(){clearInterval(playerMoveTimer); playerMoveTimer=setInterval(updatePlayerMovement,16);}
function startGameTimer(){clearInterval(gameTimer); gameTimer=setInterval(()=>{timeLeft--; timerDisplay.textContent=timeLeft; if(timeLeft<=0) endGame();},1000);}

function spawnCoins(){clearInterval(coinTimer); coinTimer=setInterval(()=>{
    if(!gameActive) return; 
    const coin=document.createElement('div'); coin.className='coin'; 
    coin.style.left=Math.random()*700+50+'px'; coin.style.top='50px'; 
    gameContainer.appendChild(coin);
    let coinY=50; const fall=setInterval(()=>{
        if(!gameActive){clearInterval(fall); coin.remove(); return;}
        coinY+=2; coin.style.top=coinY+'px';
        if(coinY>500){clearInterval(fall); coin.remove();}
        if(checkCollision(player,coin)){collectCoin(coin); clearInterval(fall);}
    },20);
},1500);}

function spawnObstacles(){
    const imagens = [
        'assets/obstaculos/bola.png',
        'assets/obstaculos/estrela.png',
        'assets/obstaculos/meteoro.png',
        'assets/obstaculos/pedra.png'
    ];

    clearInterval(obstacleTimer);
    obstacleTimer = setInterval(()=>{
        if(!gameActive) return;

        const obs = document.createElement('img');
        const src = imagens[Math.floor(Math.random()*imagens.length)];
        obs.src = src;
        obs.className = 'obstacle';
        obs.style.width = (Math.random()*50+30)+'px';
        obs.style.height = (Math.random()*50+30)+'px';
        obs.style.left = Math.random()*700+50+'px';
        obs.style.top = '50px';
        gameContainer.appendChild(obs);

        let obsY = 5;
        const fall = setInterval(()=>{
            if(!gameActive){ clearInterval(fall); obs.remove(); return; }
            obsY += 3;
            obs.style.top = obsY+'px';
            if(obsY>500){ clearInterval(fall); obs.remove(); }
            if(checkCollision(player, obs)){ endGame(); clearInterval(fall); }
        },20);
    },2000);
}


function collectCoin(coin){coin.classList.add('collect-animation'); score+=10; coinsCollected++; scoreDisplay.textContent=score; setTimeout(()=>coin.remove(),500);}
function checkCollision(a,b){const r1=a.getBoundingClientRect(),r2=b.getBoundingClientRect(); return !(r1.right<r2.left || r1.left>r2.right || r1.bottom<r2.top || r1.top>r2.bottom);}
function endGame(){gameActive=false; clearInterval(gameTimer); clearInterval(obstacleTimer); clearInterval(coinTimer); clearInterval(playerMoveTimer);
    document.querySelectorAll('.coin,.obstacle').forEach(el=>el.remove());
    finalScoreDisplay.textContent=score; coinsCollectedDisplay.textContent=coinsCollected; gameOverScreen.classList.remove('hidden');}
function restartGame(){endGame(); startGame();}
window.addEventListener('load', init);
</script>
</body>
</html>
